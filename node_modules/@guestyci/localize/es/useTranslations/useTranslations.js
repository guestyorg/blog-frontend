import { useMemo, useState, useContext } from 'react';
import isObject from 'lodash/isObject';
import LocalizationContext from "../LocalizationProvider/LocalizationContext";
import { intl } from "../utils/i18nUtility";

const getFormattedTranslations = (items = []) => items.map(item => {
  const defaultMessage = item.d || item.defaultMessage;
  return intl.get(item.id, item.variables, defaultMessage).d(defaultMessage);
});

const useTranslations = (items = [], deps = []) => {
  const {
    language
  } = useContext(LocalizationContext);
  return useMemo(() => {
    const isMultiTranslate = isObject(items[0]);
    return isMultiTranslate ? getFormattedTranslations(items) : [intl.get(items[0]).d(items[1])];
  }, [language, ...deps]);
};

export default useTranslations;