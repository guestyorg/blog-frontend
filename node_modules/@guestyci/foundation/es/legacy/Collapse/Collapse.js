import _extends from "@babel/runtime/helpers/esm/extends";
import _objectWithoutPropertiesLoose from "@babel/runtime/helpers/esm/objectWithoutPropertiesLoose";

/* eslint no-param-reassign: 0 */
import React from 'react';
import PropTypes from 'prop-types';
import cn from 'classnames';
import Transition from 'react-transition-group/Transition';

const Collapse = (_ref) => {
  let {
    children,
    isOpen,
    className,
    duration,
    onEntered,
    onExited,
    lazyMount
  } = _ref,
      props = _objectWithoutPropertiesLoose(_ref, ["children", "isOpen", "className", "duration", "onEntered", "onExited", "lazyMount"]);

  const handleEnter = (node, isAppearing) => {
    if (isAppearing) {
      node.style.height = 'auto';
    } else {
      node.style.height = 0;
    }
  };

  const handleEntering = node => {
    const height = node.scrollHeight;
    node.style.transitionDuration = `${duration}ms`;
    node.style.height = `${height}px`;
  };

  const handleEntered = (node, isAppearing) => {
    node.style.height = 'auto';

    if (onEntered) {
      onEntered(node, isAppearing);
    }
  };

  const handleExit = node => {
    const height = node.scrollHeight;
    node.style.height = `${height}px`;
  };

  const handleExiting = node => {
    setTimeout(() => {
      node.style.transitionDuration = `${duration}ms`;
      node.style.height = 0;
    }, 0);
  };

  return /*#__PURE__*/React.createElement(Transition, _extends({
    in: isOpen,
    appear: true,
    timeout: duration,
    onEnter: handleEnter,
    onEntering: handleEntering,
    onExit: handleExit,
    onExiting: handleExiting,
    onEntered: handleEntered,
    onExited: onExited,
    mountOnEnter: lazyMount,
    unmountOnExit: lazyMount
  }, props, {
    "data-qa": "collapse"
  }), /*#__PURE__*/React.createElement("div", {
    className: cn('w-fill', 'height-0', 'overflow-hidden', className)
  }, children));
};

Collapse.defaultProps = {
  duration: 350,
  lazyMount: false,
  className: ''
};
Collapse.propTypes = {
  /** Indicator whether or not collapse should be open */
  isOpen: PropTypes.bool.isRequired,

  /** Children to render when collapse is open */
  children: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.node), PropTypes.node]).isRequired,

  /** Duration of the animation */
  duration: PropTypes.number,

  /** Function to be executed when the collapse is opened
   * (node: HtmlElement, isAppearing: bool) -> void
   */
  onEntered: PropTypes.func,

  /** Function to be executed when the collapse is closed
   * (node: HtmlElement, isAppearing: bool) -> void
   */
  onExited: PropTypes.func,

  /** Mount the child component in a lazy fashion.
   * Meaning, mounted when expended and unmounted when collapsed */
  lazyMount: PropTypes.bool,
  className: PropTypes.string
};
export default Collapse;