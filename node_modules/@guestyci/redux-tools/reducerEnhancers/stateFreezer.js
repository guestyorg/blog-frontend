"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.stateFreezer = stateFreezer;

var _typeof2 = _interopRequireDefault(require("@babel/runtime/helpers/typeof"));

function deepFreeze(obj) {
  Object.freeze(obj);
  var oIsFunction = typeof obj === 'function';
  var hasOwnProp = Object.prototype.hasOwnProperty;
  Object.getOwnPropertyNames(obj).forEach(function (prop) {
    if (hasOwnProp.call(obj, prop) && (oIsFunction ? prop !== 'caller' && prop !== 'callee' && prop !== 'arguments' : true) && obj[prop] !== null && ((0, _typeof2["default"])(obj[prop]) === 'object' || typeof obj[prop] === 'function') && !Object.isFrozen(obj[prop])) {
      deepFreeze(obj[prop]);
    }
  });
  return obj;
} // eslint-disable-next-line import/prefer-default-export


function stateFreezer(reducer) {
  return function freezer(state, action) {
    // freeze the state and run the original reducer
    deepFreeze(state);
    var newState = reducer(state, action); // freeze and return the result state

    deepFreeze(newState);
    return newState;
  };
}