# Redux Tools

A tools lib for Redux

## Installation

- npm:
  ```
  npm install @guestyci/redux-tools
  ```
- yarn:
  ```
  yarn add @guestyci/redux-tools
  ```

## Tools

1. `makeAsyncActionCreator`:

   ```
       const asyncActions = makeAsyncActionCreator(FEATURE_TYPE, 'items,page,count', 'error', 'isRequesting');
   ```

   Similar to makeActionCreator, this function accepts the action type and the payload structure for success, failure, request.  
   Although here in order to define multiple items in each dispatch we separate them by comma(no spaces).  
   The return is an object containing the request, success, failure actions.  
    You can use like so:

   ```
       export function fetchItems(id, q, page = 0, limit = FETCH_LIMIT) {
          return async (dispatch, getState, api) => {
            dispatch(fetchItemsActions.request());
            try {
              const resp = await api.get(url, {
                skip: page * limit,
                limit,
                q,
              });

              const { data: { results, count } } = resp;
              dispatch(fetchItemsActions.success(
                deserializeData(results),
                page,
                Math.ceil(count / limit) - 1,
              ));
            } catch (err) {
              dispatch(fetchItemsActions.failure(err));
            }
          };
        }
   ```

   This method automatically sets the `API_SUCCESS`, `API_FAILURE` and `API_REQUEST` to each action. So in the reducer we can assume they are there. Like so:

   ```
       export default (state = initialState, action) => {
          switch (action.type) {
            case `${FEATURE_TYPE} ${API_REQUEST}`:
            return //logic here
            case `${FEATURE_TYPE} ${API_FAILURE}`:
            return //logic here
            case `${FEATURE_TYPE} ${API_SUCCESS}`:
            return //logic here
            default:
              return state;
          }
        };
   ```

   That is it. You created all action creators in with one simple function.

   Additionally To simplify things, the api also by default puts the actions in a payload object
   How to use:

   ```
         import { makeAsyncActionCreator } from '@guestyci/redux-tools';
          const fetchItemsActions = makeAsyncActionCreator(FEATURE_TYPE);
          export function fetchItems(id, q, page = 0, limit = FETCH_LIMIT) {
            return async (dispatch, getState, api) => {
              dispatch(fetchItemsActions.request());
              try {
                const resp = await api.get(url, {
                  skip: page * limit,
                  limit,
                  q,
                });

                const { data: { results, count } } = resp;
                dispatch(fetchItemsActions.success({
                      items: deserializeData(results),
                      page,
                      count: Math.ceil(count / limit) - 1,
                  }
                ));
              } catch (err) {
                dispatch(fetchItemsActions.failure(err));
              }
            };
          }
   ```

   By default this function will set a `payload` object to the action.  
   So in the reducer you will access your payload in `action.payload`

2. `makeActionCreator`:

   What does this do? The makeActionCreator function will create an action for you.  
   Where the first argument is the action type to be dispatch, and the rest are the payload structure we will be expecting. Basically this will generate

   ```
       export const action = (foo, bar, ...) => ({
         type: 'FEATURE_TYPE',
         foo,
         bar,
         ...
       })
   ```

   Then call it like so:

   ```
       dispatch(action('foo', 'bar'));
   ```

   Or inside a container with bindActionCreators (it auto attaches the dispatch):

   ```
       action('foo', 'bar'));
   ```

   this will dispatch to reducers with the actions:

   ```
      {argument1: 'foo', argument2: 'bar', ....};
   ```
