"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.useStyles = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _classnames = _interopRequireDefault(require("classnames"));

var _CSSTransition = _interopRequireDefault(require("../CSSTransition"));

var _createStyles = _interopRequireDefault(require("../createStyles"));

var useStyles = (0, _createStyles["default"])(function (theme) {
  return {
    appear: {
      visibility: 'hidden'
    },
    fadeEnter: {
      opacity: 0
    },
    fadeEnterActive: {
      opacity: 1,
      transition: function transition(_ref) {
        var duration = _ref.duration;
        return theme.transition.create('opacity', {
          duration: duration
        });
      }
    },
    fadeEnterDone: {
      opacity: 1
    },
    fadeExit: {
      opacity: 1
    },
    fadeExitActive: {
      opacity: 0,
      transition: function transition(_ref2) {
        var duration = _ref2.duration;
        return theme.transition.create('opacity', {
          duration: duration
        });
      }
    },
    fadeExitDone: {
      opacity: 0
    }
  };
}, {
  name: 'Fade'
});
exports.useStyles = useStyles;

var Fade = _react["default"].forwardRef(function Fade(_ref3, ref) {
  var className = _ref3.className,
      timeout = _ref3.timeout,
      children = _ref3.children,
      Tag = _ref3.tag,
      show = _ref3.show,
      duration = _ref3.duration,
      jss = _ref3.jss,
      rest = (0, _objectWithoutProperties2["default"])(_ref3, ["className", "timeout", "children", "tag", "show", "duration", "jss"]);
  var classes = useStyles({
    duration: duration,
    jss: jss
  });
  var appearCache = (0, _react.useRef)(false);
  (0, _react.useEffect)(function () {
    if (show) {
      appearCache.current = true;
    }
  }, [show]);
  return /*#__PURE__*/_react["default"].createElement(_CSSTransition["default"], (0, _extends2["default"])({
    ref: ref,
    show: !!show,
    animation: {
      enter: classes.fadeEnter,
      enterActive: classes.fadeEnterActive,
      enterDone: classes.fadeEnterDone,
      exit: classes.fadeExit,
      exitDone: classes.fadeExitDone,
      exitActive: classes.fadeExitActive
    },
    className: (0, _classnames["default"])(className, (0, _defineProperty2["default"])({}, classes.appear, !show && !appearCache.current)),
    timeout: timeout
  }, rest), /*#__PURE__*/_react["default"].createElement(Tag, null, children));
});

Fade.defaultProps = {
  className: '',
  tag: 'span',
  children: null
};
Fade.propTypes = {
  /** Bool whether or not to show (fade in) children */
  show: _propTypes["default"].bool,

  /** Additional class for root level */
  className: _propTypes["default"].string,

  /** children to render for the fade component */
  children: _propTypes["default"].oneOfType([_propTypes["default"].node, _propTypes["default"].arrayOf(_propTypes["default"].node)]),

  /** Timeout for fade animation */
  timeout: _propTypes["default"].oneOfType([_propTypes["default"].shape({
    enter: _propTypes["default"].number.isRequired,
    exit: _propTypes["default"].number.isRequired
  }), _propTypes["default"].number]),

  /** Tag to render for fade */
  tag: _propTypes["default"].string,

  /** customize the transition duration */
  duration: _propTypes["default"].number,

  /** jss override object to customize the jss classes */
  jss: _propTypes["default"].oneOfType([_propTypes["default"].shape(), _propTypes["default"].func])
};
Fade.displayName = 'Fade';
var _default = Fade;
exports["default"] = _default;