#!/usr/bin/env node

const ora = require('ora');
const spinner = ora({ spinner: 'triangle', color: 'blue' });

const { loadPackageJson, writePackageJson } = require('../util/files');
const { bootstrap } = require('../scripts/bootstrap');

const start = async () => {
  try {
    const scripts = {
      'deploy:storybook': 'ebisu push-sb-branch',
    };

    bootstrap('package');

    spinner.start('Appending new scripts, please wait.');

    const packageJson = loadPackageJson();

    packageJson.scripts = { ...packageJson.scripts, ...scripts };
    writePackageJson(packageJson);

    spinner.succeed('new scripts added!');
  } catch (e) {
    spinner.stop();
    throw e;
  }
};

module.exports = start;
