"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _react = require("react");

var cachedScripts = new Set();

function useScript(src) {
  var _useState = (0, _react.useState)(false),
      _useState2 = (0, _slicedToArray2["default"])(_useState, 2),
      loaded = _useState2[0],
      setLoaded = _useState2[1];

  var _useState3 = (0, _react.useState)(false),
      _useState4 = (0, _slicedToArray2["default"])(_useState3, 2),
      error = _useState4[0],
      setError = _useState4[1];

  (0, _react.useEffect)(function () {
    var script = document.createElement('script');

    var loadScript = function loadScript() {
      script.src = src;
      script.async = true;
      return new Promise(function (resolve, reject) {
        script.addEventListener('load', function () {
          return resolve(src);
        });
        script.addEventListener('error', function (e) {
          return reject(e);
        });
        document.body.appendChild(script);
      })["catch"](function (e) {
        throw e;
      });
    };

    var processRequestedScript = function processRequestedScript() {
      if (cachedScripts.has(src)) {
        setError(false);
        setLoaded(true);
      } else {
        var promise = loadScript();
        promise["catch"](function () {
          cachedScripts["delete"](src);
          setError(true);
          setLoaded(false);
        }).then(function () {
          cachedScripts.add(src);
          setError(false);
          setLoaded(true);
        });
      }
    };

    processRequestedScript();
  }, [src]);
  return [loaded, error];
}

var _default = useScript;
exports["default"] = _default;