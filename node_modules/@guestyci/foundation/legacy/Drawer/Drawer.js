"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _react = _interopRequireWildcard(require("react"));

var _classnames = _interopRequireDefault(require("classnames"));

var _reactJss = require("react-jss");

var _propTypes = _interopRequireDefault(require("prop-types"));

var _Paper = _interopRequireDefault(require("../Paper"));

var calculateDrawerWrapperHeight = function calculateDrawerWrapperHeight(isOpen, overlay) {
  if (overlay) {
    return '100%';
  }

  return isOpen ? '100%' : 0;
};

var useStyles = (0, _reactJss.createUseStyles)({
  wrapper: {
    transition: 'width 225ms cubic-bezier(0, 0, 0.2, 1) 0ms, height 220ms cubic-bezier(0, 0, 0.2, 1) 0ms',
    width: function width(_ref) {
      var isOpen = _ref.isOpen,
          _width = _ref.width;
      return isOpen ? _width : 0;
    },
    height: function height(_ref2) {
      var isOpen = _ref2.isOpen,
          overlay = _ref2.overlay;
      return calculateDrawerWrapperHeight(isOpen, overlay);
    },
    overflow: 'hidden'
  },
  drawer: {
    transition: 'transform 225ms cubic-bezier(0, 0, 0.2, 1) 0ms',
    transform: "translateX(".concat(function (_ref3) {
      var isOpen = _ref3.isOpen;
      return isOpen ? 0 : '-100%';
    }, ")"),
    width: function width(_ref4) {
      var _width2 = _ref4.width;
      return _width2;
    }
  }
});

var Drawer = function Drawer(_ref5) {
  var overlay = _ref5.overlay,
      className = _ref5.className,
      style = _ref5.style,
      isOpen = _ref5.isOpen,
      children = _ref5.children,
      width = _ref5.width,
      elevation = _ref5.elevation,
      right = _ref5.right,
      bgColor = _ref5.bgColor,
      containerClassName = _ref5.containerClassName,
      fixed = _ref5.fixed,
      onDrawerTransitionEnd = _ref5.onDrawerTransitionEnd;
  var drawerRef = (0, _react.useRef)();
  var classes = useStyles({
    isOpen: isOpen,
    width: width,
    overlay: overlay
  });
  (0, _react.useEffect)(function () {
    if (drawerRef.current && overlay) {
      var el = drawerRef.current;
      var parent = el.parentElement;
      parent.classList.toggle('relative');
    }
  }, [overlay]);
  return /*#__PURE__*/_react["default"].createElement(_Paper["default"], {
    elevation: elevation,
    ref: drawerRef,
    bgColor: bgColor,
    className: (0, _classnames["default"])(classes.wrapper, 'zindex-5 flex-shrink-0', {
      'right-0': overlay && right
    }, {
      absolute: overlay
    }, {
      fixed: fixed
    }, containerClassName),
    style: style,
    onTransitionEnd: onDrawerTransitionEnd,
    "data-qa": "drawer"
  }, /*#__PURE__*/_react["default"].createElement("div", {
    className: (0, _classnames["default"])(classes.drawer, 'd-flex-fill h-fill flex-column overyflow-y-auto', className)
  }, children));
};

Drawer.defaultProps = {
  className: '',
  style: {},
  width: 250,
  overlay: false,
  right: false,
  elevation: 1,
  bgColor: '',
  containerClassName: '',
  fixed: false
};
Drawer.propTypes = {
  /** Indicator whether or not to show drawer */
  isOpen: _propTypes["default"].bool.isRequired,

  /** Child elements inside drawer */
  children: _propTypes["default"].oneOfType([_propTypes["default"].arrayOf(_propTypes["default"].node), _propTypes["default"].node]).isRequired,

  /** Additional classes to drawer level */
  className: _propTypes["default"].string,

  /** Additional style to root level */
  style: _propTypes["default"].shape(),

  /** drawer width */
  width: _propTypes["default"].number,

  /** indicator whether or not drawer should overlay over content (position absolute) or static
   * *Note - overlay auto toggles parent component with position relative
   * */
  overlay: _propTypes["default"].bool,

  /** Only applicable for overlay = true -
   *  Indicator whether or not we want to open drawer on right - default left
   *  */
  right: _propTypes["default"].bool,

  /** The drawer paper elevation level * */
  elevation: _propTypes["default"].number,

  /** Background color for drawer */
  bgColor: _propTypes["default"].string,

  /** Add class to root level */
  containerClassName: _propTypes["default"].string,

  /** Set drawer as fixed */
  fixed: _propTypes["default"].bool,

  /** Callback hook for the Drawer slide transition end */
  onDrawerTransitionEnd: _propTypes["default"].func
};
var _default = Drawer;
exports["default"] = _default;